# GCS Implementation Checklist\n\n## ðŸŽ¯ Phase 1: Setup (Day 1)\n\n### Environment Configuration\n- [ ] Go to Project Settings\n- [ ] Navigate to Environment Variables\n- [ ] Add `GCS_BUCKET_NAME`\n- [ ] Add `GCP_PROJECT_ID`\n- [ ] Add `GCP_CLIENT_EMAIL`\n- [ ] Add `GCP_SERVICE_ACCOUNT_BASE64`\n- [ ] Verify all variables are set\n- [ ] Restart dev server\n\n### Database Preparation\n- [ ] Access Supabase SQL Editor\n- [ ] Copy migration: `supabase/migrations/20240220_add_gcs_image_support.sql`\n- [ ] Run migration\n- [ ] Verify new columns created:\n  - [ ] `tours.hero_image_url`\n  - [ ] `tours.gallery_image_urls`\n  - [ ] `destinations.image_url`\n  - [ ] `activities.image_url`\n\n### API Endpoint Testing\n- [ ] Start dev server\n- [ ] Test with cURL:\n  ```bash\n  curl -X POST http://localhost:3000/api/upload-image \\\n    -F \"file=@test.jpg\" \\\n    -F \"entityType=tour\" \\\n    -F \"entityId=test-123\"\n  ```\n- [ ] Verify response includes `publicUrl`\n- [ ] Verify response includes `storagePath`\n- [ ] Check GCS console for uploaded file\n- [ ] Verify file is publicly accessible\n\n---\n\n## ðŸ”§ Phase 2: Integration (Day 2-3)\n\n### Tour Form Integration\n- [ ] Open `src/app/admin/tour-form-modal.tsx`\n- [ ] Add import: `import ImageUpload from '@/components/admin/image-upload';`\n- [ ] Locate hero image input section (around line 359)\n- [ ] Add ImageUpload component:\n  ```tsx\n  {tour && (\n    <ImageUpload\n      entityType=\"tour\"\n      entityId={tour.id}\n      onImageUpload={(result) => setValue('hero_image_url', result.publicUrl)}\n      label=\"Upload Hero Image\"\n    />\n  )}\n  ```\n- [ ] Test upload in tour form\n- [ ] Verify image URL stored in database\n\n### Destination Form Integration\n- [ ] Open destination form component\n- [ ] Add ImageUpload import\n- [ ] Add component for destination image\n- [ ] Wire up to `image_url` field\n- [ ] Test upload\n\n### Activity Form Integration\n- [ ] Open activity form component\n- [ ] Add ImageUpload import\n- [ ] Add component for activity image\n- [ ] Wire up to appropriate field\n- [ ] Test upload\n\n### Component Testing\n- [ ] Test drag-and-drop upload\n- [ ] Test click-to-select upload\n- [ ] Test file validation (invalid types)\n- [ ] Test file validation (too large)\n- [ ] Verify success message shows\n- [ ] Verify image preview displays\n- [ ] Verify URL in form field\n\n---\n\n## âœ… Phase 3: Validation (Day 3-4)\n\n### End-to-End Testing\n- [ ] Create new tour with image upload\n- [ ] Verify image in GCS bucket\n- [ ] Verify image URL in database\n- [ ] Verify public URL accessible\n- [ ] Edit tour and upload different image\n- [ ] Verify new image in GCS\n- [ ] Verify database updated\n\n### Gallery Upload (if applicable)\n- [ ] Test multiple image uploads\n- [ ] Verify array stored in database\n- [ ] Verify all URLs public\n- [ ] Test gallery display on front-end\n\n### Error Handling\n- [ ] Test with invalid file type (.pdf, .txt, etc.)\n- [ ] Test with oversized file (>10MB)\n- [ ] Test with network interruption (if possible)\n- [ ] Verify error messages display\n- [ ] Verify upload can be retried\n\n### Performance Testing\n- [ ] Upload small image (<1MB) - should be instant\n- [ ] Upload medium image (1-5MB) - should be <3 seconds\n- [ ] Upload large image (5-10MB) - should be <10 seconds\n- [ ] Upload multiple images in sequence\n- [ ] Verify no memory leaks\n\n---\n\n## ðŸš€ Phase 4: Production Deployment\n\n### Pre-Deployment\n- [ ] All features tested locally\n- [ ] All error cases handled\n- [ ] Code reviewed\n- [ ] No hardcoded credentials\n- [ ] Environment variables documented\n\n### Production Setup\n- [ ] Environment variables set in production\n- [ ] Database migration run in production\n- [ ] GCS bucket configured in production\n- [ ] Service account permissions verified\n- [ ] Backup policy configured\n\n### Production Testing\n- [ ] Test upload endpoint in production\n- [ ] Verify images in production GCS bucket\n- [ ] Verify database queries working\n- [ ] Test image display on live site\n- [ ] Monitor for errors in logs\n\n### Monitoring\n- [ ] Set up GCS cost alerts\n- [ ] Monitor storage growth\n- [ ] Track failed uploads\n- [ ] Monitor API response times\n- [ ] Check for security issues\n\n---\n\n## ðŸ“‹ Documentation\n\n### Internal Documentation\n- [ ] Update project README with GCS info\n- [ ] Add API documentation to postman/swagger\n- [ ] Document environment variable requirements\n- [ ] Create runbook for common issues\n\n### Team Communication\n- [ ] Notify team of new upload system\n- [ ] Share GCS_QUICK_REFERENCE.md with developers\n- [ ] Conduct brief training session\n- [ ] Answer team questions\n\n---\n\n## ðŸ”„ Ongoing Maintenance\n\n### Weekly\n- [ ] Check GCS storage growth\n- [ ] Review upload success rates\n- [ ] Monitor for security issues\n- [ ] Check error logs\n\n### Monthly\n- [ ] Analyze storage costs\n- [ ] Review and optimize images\n- [ ] Update documentation if needed\n- [ ] Plan for scaling if needed\n\n### Quarterly\n- [ ] Review and update backup policies\n- [ ] Analyze usage patterns\n- [ ] Optimize storage structure if needed\n- [ ] Plan for feature enhancements\n\n---\n\n## ðŸŽ¯ Success Criteria\n\n### Functional\n- âœ… Images upload successfully to GCS\n- âœ… Public URLs generated correctly\n- âœ… URLs stored in Supabase\n- âœ… Images accessible from front-end\n- âœ… Error handling works\n- âœ… Validation works\n\n### Performance\n- âœ… Upload time < 10 seconds for 10MB file\n- âœ… API response time < 100ms\n- âœ… No memory leaks\n- âœ… Handles concurrent uploads\n\n### Security\n- âœ… No credentials in code\n- âœ… Service account auth working\n- âœ… MIME type validation working\n- âœ… File size limits enforced\n- âœ… CORS properly configured\n\n### Usability\n- âœ… Clear UI for users\n- âœ… Error messages helpful\n- âœ… Progress indication shown\n- âœ… Success confirmation visible\n\n---\n\n## ðŸ› Troubleshooting Guide\n\n### Issue: \"GCP_SERVICE_ACCOUNT_BASE64 not set\"\n```\nSolution:\n1. Go to Project Settings\n2. Add environment variable\n3. Restart dev server\n4. Verify in env: console.log(process.env.GCP_SERVICE_ACCOUNT_BASE64)\n```\n\n### Issue: \"File upload fails with 403\"\n```\nSolution:\n1. Check GCS bucket permissions\n2. Verify service account email\n3. Check service account has Storage Editor role\n4. Review cloud audit logs\n```\n\n### Issue: \"Upload succeeds but URL returns 404\"\n```\nSolution:\n1. Verify file in GCS bucket\n2. Check file permissions (should be public)\n3. Run: gcsFile.makePublic() in code\n4. Wait 5 minutes for caching\n```\n\n### Issue: \"Slow uploads\"\n```\nSolution:\n1. Check network speed\n2. Check file size\n3. Consider compressing images\n4. Check GCS API limits\n```\n\n---\n\n## âœ¨ Quick Reference\n\n### Files Created\n```\nsrc/lib/gcs-client.ts\nsrc/lib/gcs-upload.ts\nsrc/app/api/upload-image/route.ts\nsrc/components/admin/image-upload.tsx\nsrc/hooks/use-image-upload.ts\nsupabase/migrations/20240220_add_gcs_image_support.sql\n```\n\n### Documentation Files\n```\nGCS_INDEX.md (START HERE)\nGCS_QUICK_REFERENCE.md\nGCS_INTEGRATION_GUIDE.md\nGCS_IMPLEMENTATION_SUMMARY.md\nGCS_ARCHITECTURE_DIAGRAM.md\n```\n\n### Key Dates\n- Phase 1 Setup: ~2 hours\n- Phase 2 Integration: ~4 hours\n- Phase 3 Validation: ~2 hours\n- Phase 4 Deployment: ~1 hour\n- **Total**: ~9 hours\n\n---\n\n## ðŸ“Š Status Tracker\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Phase 1: Setup         [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘] â”‚\nâ”‚ Phase 2: Integration   [â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] â”‚\nâ”‚ Phase 3: Validation    [â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] â”‚\nâ”‚ Phase 4: Deployment    [â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n## ðŸŽ‰ Completion\n\nWhen all checkboxes are complete:\n- âœ… GCS integration is production-ready\n- âœ… Team is trained\n- âœ… Documentation is complete\n- âœ… Monitoring is in place\n- âœ… Ready for full deployment\n\n---\n\n**Last Updated**: February 2024  \n**Version**: 1.0  \n**Owner**: [Your Team]  \n**Contact**: [Support Channel]\n"